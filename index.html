<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Luan Financeiro</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="theme-color" content="#0b132b">

<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
  background:#0b132b;
  color:#fff;
  padding:20px;
}
h1{
  text-align:center;
  font-weight:700;
}
.card{
  background:#111c3a;
  border-radius:16px;
  padding:18px;
  margin-bottom:16px;
}
.titulo{font-size:14px;opacity:.7;margin-bottom:6px}
.valor-grande{font-size:32px;font-weight:700}
input,button,select{
  width:100%;
  padding:12px;
  margin-top:8px;
  border-radius:10px;
  border:none;
  font-size:15px;
}
input,select{background:#0b132b;color:#fff}
button{background:#19e3c2;color:#000;font-weight:600}
.progress{
  height:10px;
  background:#0b132b;
  border-radius:10px;
  overflow:hidden;
  margin-top:8px;
}
.progress div{height:100%;background:#19e3c2}
table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
  font-size:14px;
}
th,td{
  padding:8px;
  border-bottom:1px solid #1f2b55;
  text-align:center;
}
th{opacity:.7}
.small{font-size:12px;opacity:.7}
</style>
</head>

<body>

<h1>Luan Financeiro</h1>

<!-- SALDO -->
<div class="card">
  <div class="titulo">Saldo atual</div>
  <div class="valor-grande" id="saldo">R$ 0,00</div>
</div>

<!-- MOVIMENTAÇÃO -->
<div class="card">
  <div class="titulo">Adicionar / Retirar dinheiro</div>
  <input id="valorMov" type="number" placeholder="Valor">
  <select id="tipoMov">
    <option value="add">Adicionar dinheiro</option>
    <option value="sub">Retirar dinheiro</option>
  </select>
  <button onclick="movimentar()">Salvar</button>
</div>

<!-- META MENSAL AVANÇADA -->
<div class="card">
  <div class="titulo">Meta mensal</div>

  <input id="mesNome" placeholder="Mês (ex: Abril)">
  <input id="metaMes" type="number" placeholder="Meta do mês">
  <input id="diasMes" type="number" placeholder="Quantidade de dias do mês">

  <div class="small" id="valorDia"></div>

  <div class="progress"><div id="barraMes"></div></div>

  <button onclick="resetarMes()">Resetar mês</button>
</div>

<!-- PLANILHA DIÁRIA -->
<div class="card">
  <div class="titulo">Planilha diária para juntar dinheiro</div>

  <input id="dia" type="number" placeholder="Dia do mês">
  <input id="valorDiaGuardado" type="number" placeholder="Valor do dia">
  <button onclick="guardarDia()">Guardar no dia</button>

  <table>
    <thead>
      <tr>
        <th>Dia</th>
        <th>Valor</th>
      </tr>
    </thead>
    <tbody id="tabela"></tbody>
  </table>
</div>

<script>
const KEY = "luan_financeiro_diario";

let dados = JSON.parse(localStorage.getItem(KEY)) || {
  saldo:0,
  mes:"",
  metaMes:0,
  diasMes:0,
  guardadoMes:0,
  dias:[]
};

const saldoEl = document.getElementById("saldo");
const tabela = document.getElementById("tabela");
const barraMes = document.getElementById("barraMes");
const valorDiaInfo = document.getElementById("valorDia");

function salvar(){
  localStorage.setItem(KEY, JSON.stringify(dados));
}

function atualizar(){
  saldoEl.innerText = "R$ " + dados.saldo.toFixed(2);

  const pct = dados.metaMes
    ? Math.min((dados.guardadoMes / dados.metaMes) * 100, 100)
    : 0;
  barraMes.style.width = pct + "%";

  if(dados.metaMes && dados.diasMes){
    valorDiaInfo.innerText =
      "Sugestão por dia: R$ " +
      (dados.metaMes / dados.diasMes).toFixed(2);
  }

  tabela.innerHTML = "";
  dados.dias.forEach(d=>{
    tabela.innerHTML += `
      <tr>
        <td>${d.dia}</td>
        <td>R$ ${d.valor.toFixed(2)}</td>
      </tr>
    `;
  });

  salvar();
}

function movimentar(){
  const v = Number(valorMov.value);
  if(!v) return;
  if(tipoMov.value === "add") dados.saldo += v;
  else dados.saldo -= v;
  valorMov.value="";
  atualizar();
}

function guardarDia(){
  const dia = Number(document.getElementById("dia").value);
  const v = Number(valorDiaGuardado.value);
  if(!dia || !v) return;

  if(v > dados.saldo){
    alert("Saldo insuficiente");
    return;
  }

  dados.saldo -= v;
  dados.guardadoMes += v;
  dados.dias.push({ dia, valor:v });

  dia.value="";
  valorDiaGuardado.value="";
  atualizar();
}

function resetarMes(){
  if(!confirm("Deseja resetar o mês?")) return;
  dados.guardadoMes = 0;
  dados.dias = [];
  atualizar();
}

metaMes.onchange = e => { dados.metaMes = Number(e.target.value); atualizar(); };
diasMes.onchange = e => { dados.diasMes = Number(e.target.value); atualizar(); };
mesNome.onchange = e => { dados.mes = e.target.value; salvar(); };

atualizar();
</script>

</body>
</html>
